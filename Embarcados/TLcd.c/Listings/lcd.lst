


ARM Macro Assembler    Page 1 


    1 00000000         ; LCD.s
    2 00000000         ; Desenvolvido para o Shield Tiva EK-TM4C1294XL: LCD (16
                       02B) + TECLADO Matricial (4x4) @DaLuz
    3 00000000         ; Prof. Guilherme Peron
    4 00000000         ; Prof. DaLuz
    5 00000000         ; Controle do LCD:
    6 00000000         ; RS  = PM0
    7 00000000         ; R/W = PM1
    8 00000000         ; EN  = PM2
    9 00000000         ; Barramento do LCD:
   10 00000000         ; PORT K (8bits)
   11 00000000         
   12 00000000         ; ------------------------------------------------------
                       -------------------------
   13 00000000                 THUMB                        ; Instruções do tip
                                                            o Thumb-2
   14 00000000         ; ------------------------------------------------------
                       -------------------------
   15 00000000         ; Declarações EQU - Defines
   16 00000000         ; ========================
   17 00000000         ; Definições de Valores
   18 00000000         
   19 00000000         
   20 00000000         
   21 00000000         ; ------------------------------------------------------
                       -------------------------
   22 00000000         ; Área de Código - Tudo abaixo da diretiva a seguir será
                        armazenado na memória de 
   23 00000000         ;                  código
   24 00000000                 AREA             |.text|, CODE, READONLY, ALIGN=
2
   25 00000000         
   26 00000000                 PRESERVE8        {TRUE}
   27 00000000         
   28 00000000                 IMPORT           PortM_Output
   29 00000000                 IMPORT           PortK_Output
   30 00000000                 IMPORT           SysTick_Wait1us
   31 00000000                 IMPORT           SysTick_Wait1ms
   32 00000000         
   33 00000000         ; Se alguma função do arquivo for chamada em outro arqui
                       vo 
   34 00000000                 EXPORT           LCD_Init    ; Permite chamar LC
                                                            D_Init de outro arq
                                                            uivo
   35 00000000         
   36 00000000         
   37 00000000         ;-------------------------------------------------------
                       -------------------------
   38 00000000         ; Função GPIO_Init
   39 00000000         ; Parâmetro de entrada: Não tem
   40 00000000         ; Parâmetro de saída: Não tem
   41 00000000         LCD_Init
   42 00000000         ;=====================
   43 00000000 B500            PUSH             {LR}        ;Salvar LR para pod
                                                            er chamar outra sub
                                                            rotina ...
   44 00000002         ; Espera por 13ms antes de fazer qualquer coisa
   45 00000002 F04F 0100       MOV              R1, #2_000  ;Parâmetro de entra
                                                            da da função LCD_Co



ARM Macro Assembler    Page 2 


                                                            mmand
   46 00000006 F000 F825       BL               LCD_Command ;Chama a subrotina 
                                                            que escreve comando
                                                             no LCD
   47 0000000A F04F 000D       MOV              R0, #13     ;Parâmetro de entra
                                                            da da função SysTic
                                                            k_Wait1ms
   48 0000000E F7FF FFFE       BL               SysTick_Wait1ms ;Espera 1ms por
                                                             13 vezes
   49 00000012         ; Inicializa o Display LCD 1602B:   
   50 00000012 F04F 0138       MOV              R1, #0x38   ;2 linhas / matriz 
                                                            7x5
   51 00000016 F000 F827       BL               LCD_Escreve_Inst
   52 0000001A F04F 0138       MOV              R1, #0x38   ;2 linhas / matriz 
                                                            7x5
   53 0000001E F000 F823       BL               LCD_Escreve_Inst
   54 00000022 F04F 0106       MOV              R1, #0x06
   55 00000026 F000 F81F       BL               LCD_Escreve_Inst
   56 0000002A F04F 010E       MOV              R1, #0x0E
   57 0000002E F000 F81B       BL               LCD_Escreve_Inst
   58 00000032 F04F 0101       MOV              R1, #0x01
   59 00000036 F000 F817       BL               LCD_Escreve_Inst
   60 0000003A F44F 60C8       MOV              R0, #1600
   61 0000003E F7FF FFFE       BL               SysTick_Wait1us
   62 00000042         ;Envia Texto para o Display LCD 1602B:   
   63 00000042         ; MOV R1, #'D'
   64 00000042         ; BL LCD_Escreve_Dado
   65 00000042         ; MOV R1, #'L'
   66 00000042         ; BL LCD_Escreve_Dado
   67 00000042 4A2B            LDR              R2, =UTFPR
   68 00000044         loop_str
   69 00000044 F812 1B01       LDRB             R1, [R2],#1
   70 00000048 B111            CBZ              R1, fim_loop_str
   71 0000004A F000 F829       BL               LCD_Escreve_Dado
   72 0000004E E7F9            B                loop_str
   73 00000050         
   74 00000050         fim_loop_str
   75 00000050 F85D EB04       POP              {LR}
   76 00000054         
   77 00000054         
   78 00000054         ; ------------------------------------------------------
                       -------------------------
   79 00000054         ; Função LCD_Command
   80 00000054         ; Parâmetro de entrada: R1 --> os bits RS, R/W e EN
   81 00000054         ; Parâmetro de saída: Não tem
   82 00000054         LCD_Command
   83 00000054 B500            PUSH             {LR}        ;Link Register
   84 00000056 4608            MOV              R0, R1
   85 00000058 F7FF FFFE       BL               PortM_Output
   86 0000005C BD00            POP              {PC}        ;Retorno
   87 0000005E         
   88 0000005E         
   89 0000005E         ; ------------------------------------------------------
                       -------------------------
   90 0000005E         ; Função LCD_Data
   91 0000005E         ; Parâmetro de entrada: R1 --> o valor dos dados para o 
                       LCD
   92 0000005E         ; Parâmetro de saída: Não tem
   93 0000005E         LCD_Data



ARM Macro Assembler    Page 3 


   94 0000005E B500            PUSH             {LR}        ;Link Register
   95 00000060 4608            MOV              R0, R1
   96 00000062 F7FF FFFE       BL               PortK_Output
   97 00000066 BD00            POP              {PC}        ;Retorno
   98 00000068         
   99 00000068         ; ------------------------------------------------------
                       -------------------------
  100 00000068         ; Função LCD_Escreve_Inst
  101 00000068         ; Parâmetro de entrada: R1 --> Comando em hexadecimal
  102 00000068         ; Parâmetro de saída: Não tem
  103 00000068         LCD_Escreve_Inst
  104 00000068 B500            PUSH             {LR}        ;Link Register
  105 0000006A F7FF FFF8       BL               LCD_Data    ;Coloca no barramen
                                                            to de dados o coman
                                                            do
  106 0000006E F04F 0100       MOV              R1, #2_000  ;E=0, R/W=0, RS=0
  107 00000072 F7FF FFEF       BL               LCD_Command ;Envia o comando pa
                                                            ra o LCD
  108 00000076 F04F 0006       MOV              R0, #6      ;Espera por 6us
  109 0000007A F7FF FFFE       BL               SysTick_Wait1us
  110 0000007E         
  111 0000007E F04F 0104       MOV              R1, #2_100  ;E=1, R/W=0, RS=0
  112 00000082 F7FF FFE7       BL               LCD_Command ;Envia o comando pa
                                                            ra o LCD
  113 00000086 F04F 0006       MOV              R0, #6      ;Espera por 6us
  114 0000008A F7FF FFFE       BL               SysTick_Wait1us
  115 0000008E         
  116 0000008E F04F 0100       MOV              R1, #2_000  ;E=0, R/W=0, RS=0
  117 00000092 F7FF FFDF       BL               LCD_Command ;Envia o comando pa
                                                            ra o LCD
  118 00000096 F04F 0028       MOV              R0, #40     ;Espera por 40us
  119 0000009A F7FF FFFE       BL               SysTick_Wait1us
  120 0000009E BD00            POP              {PC}        ;Retorno
  121 000000A0         
  122 000000A0         ; ------------------------------------------------------
                       -------------------------
  123 000000A0         ; Função LCD_Escreve_Dado
  124 000000A0         ; Parâmetro de entrada: R1 --> Dado em hexadecimal
  125 000000A0         ; Parâmetro de saída: Não tem
  126 000000A0         LCD_Escreve_Dado
  127 000000A0 B500            PUSH             {LR}        ;Link Register
  128 000000A2 F7FF FFDC       BL               LCD_Data    ;Coloca no barramen
                                                            to de dados o coman
                                                            do
  129 000000A6 F04F 0101       MOV              R1, #2_001  ;E=0, R/W=0, RS=1
  130 000000AA F7FF FFD3       BL               LCD_Command ;Envia o comando pa
                                                            ra o LCD
  131 000000AE F04F 0006       MOV              R0, #6      ;Espera por 6us
  132 000000B2 F7FF FFFE       BL               SysTick_Wait1us
  133 000000B6         
  134 000000B6 F04F 0105       MOV              R1, #2_101  ;E=1, R/W=0, RS=1
  135 000000BA F7FF FFCB       BL               LCD_Command ;Envia o comando pa
                                                            ra o LCD
  136 000000BE F04F 0006       MOV              R0, #6      ;Espera por 6us
  137 000000C2 F7FF FFFE       BL               SysTick_Wait1us
  138 000000C6         
  139 000000C6 F04F 0101       MOV              R1, #2_001  ;E=0, R/W=0, RS=1
  140 000000CA F7FF FFC3       BL               LCD_Command ;Envia o comando pa
                                                            ra o LCD



ARM Macro Assembler    Page 4 


  141 000000CE F04F 0028       MOV              R0, #40     ;Espera por 40us
  142 000000D2 F7FF FFFE       BL               SysTick_Wait1us
  143 000000D6         
  144 000000D6 F44F 60C8       MOV              R0, #1600
  145 000000DA F7FF FFFE       BL               SysTick_Wait1us
  146 000000DE         
  147 000000DE BD00            POP              {PC}        ;Retorno 
  148 000000E0         
  149 000000E0 45 4C 46 
              35 32 20 
              2D 20 40 
              44 61 4C 
              75 7A 00 UTFPR   DCB              "ELF52 - @DaLuz",0
  150 000000EF         
  151 000000EF 00              ALIGN                        ; garante que o fim
                                                             da seção está alin
                                                            hada 
  152 000000F0                 END                          ; fim do arquivo
              00000000 
Command Line: --debug --xref --diag_suppress=9931 --cpu=Cortex-M4.fp.sp --apcs=
interwork --depend=.\objects\lcd.d -o.\objects\lcd.o -IC:\Users\DaLuz\AppData\L
ocal\Arm\Packs\Keil\TM4C_DFP\1.1.0\Device\Include\TM4C129 --predefine="__EVAL S
ETA 1" --predefine="__UVISION_VERSION SETA 536" --predefine="TM4C1294NCPDT SETA
 1" --list=.\listings\lcd.lst lcd.s



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
Relocatable symbols

.text 00000000

Symbol: .text
   Definitions
      At line 24 in file lcd.s
   Uses
      None
Comment: .text unused
LCD_Command 00000054

Symbol: LCD_Command
   Definitions
      At line 82 in file lcd.s
   Uses
      At line 46 in file lcd.s
      At line 107 in file lcd.s
      At line 112 in file lcd.s
      At line 117 in file lcd.s
      At line 130 in file lcd.s
      At line 135 in file lcd.s
      At line 140 in file lcd.s

LCD_Data 0000005E

Symbol: LCD_Data
   Definitions
      At line 93 in file lcd.s
   Uses
      At line 105 in file lcd.s
      At line 128 in file lcd.s

LCD_Escreve_Dado 000000A0

Symbol: LCD_Escreve_Dado
   Definitions
      At line 126 in file lcd.s
   Uses
      At line 71 in file lcd.s
Comment: LCD_Escreve_Dado used once
LCD_Escreve_Inst 00000068

Symbol: LCD_Escreve_Inst
   Definitions
      At line 103 in file lcd.s
   Uses
      At line 51 in file lcd.s
      At line 53 in file lcd.s
      At line 55 in file lcd.s
      At line 57 in file lcd.s
      At line 59 in file lcd.s

LCD_Init 00000000

Symbol: LCD_Init
   Definitions
      At line 41 in file lcd.s
   Uses
      At line 34 in file lcd.s
Comment: LCD_Init used once



ARM Macro Assembler    Page 2 Alphabetic symbol ordering
Relocatable symbols

UTFPR 000000E0

Symbol: UTFPR
   Definitions
      At line 149 in file lcd.s
   Uses
      At line 67 in file lcd.s
Comment: UTFPR used once
fim_loop_str 00000050

Symbol: fim_loop_str
   Definitions
      At line 74 in file lcd.s
   Uses
      At line 70 in file lcd.s
Comment: fim_loop_str used once
loop_str 00000044

Symbol: loop_str
   Definitions
      At line 68 in file lcd.s
   Uses
      At line 72 in file lcd.s
Comment: loop_str used once
9 symbols



ARM Macro Assembler    Page 1 Alphabetic symbol ordering
External symbols

PortK_Output 00000000

Symbol: PortK_Output
   Definitions
      At line 29 in file lcd.s
   Uses
      At line 96 in file lcd.s
Comment: PortK_Output used once
PortM_Output 00000000

Symbol: PortM_Output
   Definitions
      At line 28 in file lcd.s
   Uses
      At line 85 in file lcd.s
Comment: PortM_Output used once
SysTick_Wait1ms 00000000

Symbol: SysTick_Wait1ms
   Definitions
      At line 31 in file lcd.s
   Uses
      At line 48 in file lcd.s
Comment: SysTick_Wait1ms used once
SysTick_Wait1us 00000000

Symbol: SysTick_Wait1us
   Definitions
      At line 30 in file lcd.s
   Uses
      At line 61 in file lcd.s
      At line 109 in file lcd.s
      At line 114 in file lcd.s
      At line 119 in file lcd.s
      At line 132 in file lcd.s
      At line 137 in file lcd.s
      At line 142 in file lcd.s
      At line 145 in file lcd.s

4 symbols
349 symbols in table
